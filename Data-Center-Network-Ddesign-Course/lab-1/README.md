# LAB-1
(Механошин Алексей и Подлеснов Александр)

### Планирование адресного простраанства для ЦОД(а)ю

Общая сеть для всех ЦОД-ов (для трех): ```10.100.0.0/14```
 -  (Диапазон хостов 10.100.0.1 - 10.103.255.254 )

---


1) Сеть 10.100.0.0/16 Оставим в резерве.
2) Для первого ЦОД-а суммарное: ```10.101.0.0/16``` ( 10.101.0.1 - 10.101.255.254)
3) Для второго ЦОД-а суммарное: ```10.102.0.0/16``` (10.102.0.1 - 10.102.255.254)

### Таким образом план нумерации:

### IP = 10.10**D**.**S**xy.**M**zz

Где:
* D = номер ЦОД-а
* S = номер leaf/spine (**1** - leaf, **2**- spine)
* Mzz - значения по порядку 

В ```x``` третьего октета кодируем номер Leaf или Spine
* с **1** по **5**
* 0 - для Border Leaf

В ```y``` третьего октета кодируем:
* 1 - Loopback 1 для UNDERLAY 
* 2 - Loopback 2 для OVERLAY
* 3 - резерв, напрмер дял vPC keep-alive
* 4 - p2p линк
* 5 - сервисы

---
Loopack-s:

* ```10.101.111.1/32``` - ЦОД-1, Leaf-1,  Loopack - 1
* ```10.101.112.1/32``` - ЦОД-1, Leaf-1,  Loopack - 2
* ```10.101.121.1/32``` - ЦОД-1, Leaf-2,  Loopack - 1
* ```10.101.122.1/32``` - ЦОД-1, Leaf-2,  Loopack - 2
* ```10.101.131.1/32``` - ЦОД-1, Leaf-3,  Loopack - 1
* ```10.101.132.1/32``` - ЦОД-1, Leaf-3,  Loopack - 2
* ```10.101.141.1/32``` - ЦОД-1, Leaf-4,  Loopack - 1
* ```10.101.142.1/32``` - ЦОД-1, Leaf-4,  Loopack - 2
* ```10.101.211.1/32``` - ЦОД-1, Spine-1, Loopack - 1
* ```10.101.212.1/32``` - ЦОД-1, Spine-1, Loopack - 2
* ```10.101.221.1/32``` - ЦОД-1, Spine-2, Loopack - 1
* ```10.101.222.1/32``` - ЦОД-1, Spine-2, Loopack - 2

---
Border Leaf Loopacks:

* ```10.101.11.1``` - ЦОД-1, BRD-Leaf-1 Loopack-1
* ```10.101.12.1``` - ЦОД-1, BRD-Leaf-1 Loopack-2
* ```10.101.21.1``` - ЦОД-1, BRD-Leaf-2 Loopack-1
* ```10.101.22.1``` - ЦОД-1, BRD-Leaf-2 Loopack-2

---
Примеры сетей для vPC:

* ```10.101.113.0/30``` - vPC ЦОД-1, Leaf-1 to Leaf-2 (10.101.113.1 - 10.101.113.2)
* ```10.101.133.0/30``` - vPC ЦОД-1, Leaf-3 to Leaf-4 (10.101.133.1 - 10.101.133.2)

---
Cети P2P пиров, нумерация в октете идёт со стороны Spine:

* ```10.101.214.0/30``` - сеть в ЦОД-1, Spine-1 до Leaf-1 (10.101.214.1  - 10.101.214.2)
* ```10.101.214.4/30``` - сеть в ЦОД-1, Spine-1 до Leaf-2 (10.101.214.5  - 10.101.214.6)
* ```10.101.214.8/30``` - сеть в ЦОД-1, Spine-1 до Leaf-3 (10.101.214.9  - 10.101.214.10)
* ```10.101.214.12/30```- сеть в ЦОД-1, Spine-1 до Leaf-4 (10.101.214.13 - 10.101.214.14)
* ```10.101.224.0/30``` - сеть в ЦОД-1, Spine-2 до Leaf-1 (10.101.224.1  - 10.101.224.2)
* ```10.101.224.4/30``` - сеть в ЦОД-1, Spine-2 до Leaf-2 (10.101.224.5  - 10.101.224.6)
* ```10.101.224.8/30``` - сеть в ЦОД-1, Spine-2 до Leaf-3 (10.101.224.9  - 10.101.224.10)
* ```10.101.224.12/30```- сеть в ЦОД-1, Spine-2 до Leaf-4 (10.101.224.13 - 10.101.224.14)

Или в обратную сторону:
* ```10.101.214.0/30``` - сеть в ЦОД-1, Leaf-1 до Spine-1
* ```10.101.224.0/30``` - сеть в ЦОД-1, Leaf-1 до Spine-2
* ```10.101.214.4/30``` - сеть в ЦОД-1, Leaf-2 до Spine-1
* ```10.101.224.4/30``` - сеть в ЦОД-1, Leaf-2 до Spine-2
* ```10.101.214.8/30``` - сеть в ЦОД-1, Leaf-3 до Spine-1
* ```10.101.224.8/30``` - сеть в ЦОД-1, Leaf-3 до Spine-2
* ```10.101.214.12/30```- сеть в ЦОД-1, Leaf-4 до Spine-1
* ```10.101.224.12/30```- сеть в ЦОД-1, Leaf-4 до Spine-2

---
Сети BRD Leaf-Spine:
* ```10.101.14.0/30```  - сеть в ЦОД-1, Spine-1 до BRD-Leaf-1 (10.101.14.1 - 10.101.14.2)
* ```10.101.14.4/30```  - сеть в ЦОД-1, Spine-1 до BRD-Leaf-2 (10.101.14.5 - 10.101.14.6)
* ```10.101.24.0/30```  - сеть в ЦОД-1, Spine-2 до BRD-Leaf-1 (10.101.24.1 - 10.101.24.2)
* ```10.101.24.4/30```  - сеть в ЦОД-1, Spine-2 до BRD-Leaf-2 (10.101.24.5 - 10.101.24.6)

---

Таким образом IP установлены следующим образом:

Leaf-1:
```
Interface            IP Address
Lo1                  10.101.111.1
Lo2                  10.101.112.1
Eth1/1               10.101.214.1
Eth1/2               10.101.224.1
```
Leaf-2:
```
Interface            IP Address
Lo1                  10.101.121.1
Lo2                  10.101.122.1
Eth1/1               10.101.214.5
Eth1/2               10.101.224.5
```
Leaf-3:
```
Interface            IP Address
Lo1                  10.101.131.1
Lo2                  10.101.132.1
Eth1/1               10.101.214.9
Eth1/2               10.101.224.9
```
Leaf-4:
```
Interface            IP Address
Lo1                  10.101.141.1
Lo2                  10.101.142.1
Eth1/1               10.101.214.13
Eth1/2               10.101.224.13
```

Spine-1:
```
Interface            IP Address
Lo1                  10.101.211.1
Lo2                  10.101.212.1
Eth1/1               10.101.214.2
Eth1/2               10.101.214.6
Eth1/3               10.101.214.10
Eth1/4               10.101.214.14
Eth1/6               10.101.14.2
Eth1/7               10.101.14.6
```

Spine-2:
```
Interface            IP Address
Lo1                  10.101.221.1
Lo2                  10.101.222.1
Eth1/1               10.101.224.2
Eth1/2               10.101.224.6
Eth1/3               10.101.224.10
Eth1/4               10.101.224.14
Eth1/6               10.101.24.2
Eth1/7               10.101.24.6
```

Border Leaf-1:
```
Interface            IP Address
Lo1                  10.101.11.1
Lo2                  10.101.12.1
Eth1/1               10.101.14.1
Eth1/2               10.101.24.1
```

Border Leaf-2:
```
Interface            IP Address
Lo1                  10.101.21.1
Lo2                  10.101.22.1
Eth1/1               10.101.14.5
Eth1/2               10.101.24.5
```

---

Проверяем ping-ом все соседей, со стороны Spine-1:
```
64 bytes from 10.101.214.1: icmp_seq=0 ttl=254 time=8.243 ms
64 bytes from 10.101.214.5: icmp_seq=0 ttl=254 time=9.096 ms
64 bytes from 10.101.214.9: icmp_seq=0 ttl=254 time=6.145 ms
64 bytes from 10.101.214.13: icmp_seq=0 ttl=254 time=11.35 ms
64 bytes from 10.101.14.1: icmp_seq=0 ttl=254 time=9.568 ms
64 bytes from 10.101.14.5: icmp_seq=0 ttl=254 time=11.567 ms
```
Проверяем ping-ом все соседей, со стороны Spine-2:
```
64 bytes from 10.101.224.1: icmp_seq=0 ttl=254 time=10.141 ms
64 bytes from 10.101.224.5: icmp_seq=0 ttl=254 time=7.68 ms
64 bytes from 10.101.224.9: icmp_seq=0 ttl=254 time=7.369 ms
64 bytes from 10.101.224.13: icmp_seq=0 ttl=254 time=3.866 ms
64 bytes from 10.101.24.1: icmp_seq=0 ttl=254 time=6.388 ms
64 bytes from 10.101.24.5: icmp_seq=0 ttl=254 time=5.311 ms
```
Все выполнено успешно.

Выполнено в GNS3:

![Топология-лайт](images/otus-lab1.png)
![Тпология-полная](images/otus-lab1-full.png)
